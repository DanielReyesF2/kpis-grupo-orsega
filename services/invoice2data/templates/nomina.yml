# =============================================================================
# TEMPLATE NÓMINA - CFDI DE NÓMINA
# =============================================================================
# Para recibos de nómina timbrados

issuer: CFDI Nómina

keywords:
  # Identificadores
  - recibo de nómina
  - recibo de nomina
  - cfdi de nómina
  - cfdi de nomina
  - comprobante de nómina
  - timbrado de nómina

  # Datos del trabajador
  - trabajador
  - empleado
  - número de empleado
  - curp
  - nss
  - imss
  - infonavit
  - registro patronal
  - antigüedad
  - puesto
  - departamento

  # Percepciones
  - percepciones
  - sueldo
  - salario
  - salario base
  - salario diario
  - salario integrado
  - horas extra
  - prima vacacional
  - aguinaldo
  - bono
  - comisiones
  - gratificación
  - vales de despensa
  - fondo de ahorro

  # Deducciones
  - deducciones
  - isr
  - imss trabajador
  - préstamo
  - pensión alimenticia
  - cuota sindical
  - descuento

  # Totales
  - total percepciones
  - total deducciones
  - neto a pagar
  - sueldo neto

  # Periodo
  - periodo de pago
  - fecha de pago
  - días trabajados
  - días pagados
  - quincena
  - semana
  - mensual

exclude_keywords:
  - invoice
  - bill to
  - usd
  - cfe
  - telmex
  - total a pagar

fields:
  # Empleador/Patrón
  issuer:
    parser: regex
    regex: (?:Patr[oó]n|Empleador|Empresa|Raz[oó]n\s*Social)[\s:]+([A-ZÁÉÍÓÚÑ][A-Za-zÁÉÍÓÚÑáéíóúñ0-9\s,\.&\-]{3,100})
    group: 1

  # RFC del patrón
  vat_number:
    parser: regex
    regex: (?:RFC\s*(?:Patr[oó]n)?|R\.F\.C\.)[\s:]*([A-ZÑ&]{3,4}\d{6}[A-Z0-9]{3})
    group: 1

  # Número de empleado
  invoice_number:
    parser: regex
    regex: (?:N[uú]mero\s*(?:de\s*)?[Ee]mpleado|No\.?\s*[Ee]mpleado|ID\s*[Ee]mpleado)[\s:]+([A-Z0-9\-]{3,20})
    group: 1

  # Neto a pagar (monto principal)
  amount:
    parser: regex
    regex: (?:Neto\s*a\s*[Pp]agar|Sueldo\s*[Nn]eto|Total\s*[Nn]eto)[\s:$]*\$?\s*([\d,]+\.?\d*)
    group: 1
    type: float

  # Total percepciones
  amount_untaxed:
    parser: regex
    regex: (?:Total\s*[Pp]ercepciones|Percepciones)[\s:$]*\$?\s*([\d,]+\.?\d*)
    group: 1
    type: float

  # Total deducciones
  vat:
    parser: regex
    regex: (?:Total\s*[Dd]educciones|Deducciones)[\s:$]*\$?\s*([\d,]+\.?\d*)
    group: 1
    type: float

  # Fecha de pago
  date:
    parser: regex
    regex: (?:Fecha\s*(?:de\s*)?[Pp]ago|Periodo\s*(?:de\s*)?[Pp]ago)[\s:]+(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{2,4})
    group: 1

  # CURP
  curp:
    parser: regex
    regex: (?:CURP)[\s:]+([A-Z]{4}\d{6}[HM][A-Z]{5}[A-Z0-9]{2})
    group: 1

  # NSS
  nss:
    parser: regex
    regex: (?:NSS|N[uú]mero\s*(?:de\s*)?[Ss]eguro\s*[Ss]ocial)[\s:]+(\d{11})
    group: 1

options:
  currency: MXN
  date_formats:
    - "%d/%m/%Y"
    - "%d-%m-%Y"
    - "%Y-%m-%d"
  decimal_separator: "."
  remove_whitespace: true
