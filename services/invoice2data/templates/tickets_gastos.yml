# =============================================================================
# TEMPLATE GASTOS GENERALES / TICKETS
# =============================================================================
# Para tickets y notas de venta simplificados

issuer: Ticket / Nota de Venta

keywords:
  # Identificadores
  - ticket
  - nota de venta
  - comprobante simplificado
  - recibo
  - voucher
  - nota de compra

  # Comercios comunes
  - oxxo
  - 7-eleven
  - walmart
  - soriana
  - chedraui
  - costco
  - sam's club
  - home depot
  - office depot
  - liverpool
  - sanborns
  - vips
  - starbucks

  # Gasolina
  - gasolina
  - magna
  - premium
  - diésel
  - diesel
  - litros
  - precio por litro
  - estación de servicio
  - gasolinera
  - pemex

  # Términos comunes
  - subtotal
  - iva
  - total
  - efectivo
  - cambio
  - tarjeta
  - terminal
  - cajero
  - sucursal
  - hora

exclude_keywords:
  - cfdi
  - uuid
  - folio fiscal
  - timbrado
  - nómina
  - complemento de pago

fields:
  # Comercio
  issuer:
    parser: regex
    regex: (OXXO|7-Eleven|Walmart|Soriana|Chedraui|Costco|Sam's\s*Club|Home\s*Depot|Office\s*Depot|Liverpool|Sanborns|VIPS|Starbucks|PEMEX|Gasolinera)
    group: 1

  # Número de ticket
  invoice_number:
    parser: regex
    regex: (?:Ticket|Folio|No\.?|Transacci[oó]n)[\s:#]*(\d{4,20})
    group: 1

  # Total
  amount:
    parser: regex
    regex: (?:Total|Importe|Monto)[\s:$]*\$?\s*([\d,]+\.?\d*)
    group: 1
    type: float

  # Subtotal
  amount_untaxed:
    parser: regex
    regex: (?:Subtotal|Sub[\s-]?Total)[\s:$]*\$?\s*([\d,]+\.?\d*)
    group: 1
    type: float

  # IVA
  vat:
    parser: regex
    regex: (?:IVA|I\.V\.A\.)[\s:$]*\$?\s*([\d,]+\.?\d*)
    group: 1
    type: float

  # Fecha
  date:
    parser: regex
    regex: (?:Fecha|Date)[\s:]+(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{2,4})
    group: 1

  # Sucursal
  branch:
    parser: regex
    regex: (?:Sucursal|Tienda|Local)[\s:#]+([A-Z0-9\-]{2,20})
    group: 1

  # Litros (para gasolina)
  liters:
    parser: regex
    regex: (?:Litros|Lts\.?)[\s:]+(\d+\.?\d*)
    group: 1
    type: float

  # Precio por litro
  price_per_liter:
    parser: regex
    regex: (?:Precio\s*(?:por\s*)?[Ll]itro|P/L)[\s:$]*\$?\s*([\d]+\.?\d*)
    group: 1
    type: float

options:
  currency: MXN
  date_formats:
    - "%d/%m/%Y"
    - "%d-%m-%Y"
    - "%d/%m/%y"
  decimal_separator: "."
  remove_whitespace: true
